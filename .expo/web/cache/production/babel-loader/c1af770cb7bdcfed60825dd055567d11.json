{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import React,{useState}from\"react\";import Image from\"react-native-web/dist/exports/Image\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import Button from\"react-native-web/dist/exports/Button\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import TextInput from\"react-native-web/dist/exports/TextInput\";import{useDispatch,useSelector}from'react-redux';import TextButton from\"./common/TextButton.js\";import CustomInput from\"./common/CustomInput.js\";import{setCurrentPartyCode,setCurrentPartyId}from\"../redux/user.js\";var CreateRoom=function CreateRoom(_ref){var navigation=_ref.navigation;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),textRoom=_useState2[0],setTextRoom=_useState2[1];var user=useSelector(function(state){return state.user.user;});var dispatch=useDispatch();function getCode(_party_id,_token){var response;return _regeneratorRuntime.async(function getCode$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return _regeneratorRuntime.awrap(fetch(\"https://shangrila.pythonanywhere.com/code?token=\"+_token+\"&party_id=\"+_party_id).then(function(response){return response.json();}).then(function(json){console.log(\"res test fun === \",json);return{codeParty:json.code};}).catch(function(error){console.error(error);}));case 3:response=_context.sent;console.log(\"res test fun === \",response);return _context.abrupt(\"return\",response);case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 11:;case 12:case\"end\":return _context.stop();}}},null,null,[[0,8]],Promise);}function setRoomToAp(_creator_id,_name,_token){var response;return _regeneratorRuntime.async(function setRoomToAp$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return _regeneratorRuntime.awrap(fetch(\"https://shangrila.pythonanywhere.com/createParty?token=\"+_token+\"&name=\"+_name).then(function(response){return response.json();}).then(function(json){console.log(\"json ===== ===== \",json);return{idParty:json.party_id};}).catch(function(error){console.error(error);}));case 3:response=_context2.sent;console.log(\"res ======!!======\",response);return _context2.abrupt(\"return\",response);case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 11:;case 12:case\"end\":return _context2.stop();}}},null,null,[[0,8]],Promise);}return React.createElement(View,{style:styles.container},React.createElement(View,null,React.createElement(View,{style:styles.intitule},React.createElement(Text,{style:styles.head},\"Devenir leader\")),React.createElement(View,{style:styles.intitule2},React.createElement(Text,{style:styles.head2},\"Connecte ton compte\")),React.createElement(View,{style:styles.imagerie},React.createElement(Image,{source:require(\"../assets/spotify.jpg\"),resizeMode:\"contain\",style:styles.tinyLogo,imageStyle:styles.image_imageStyle}),React.createElement(Image,{source:require(\"../assets/deezer.jpg\"),resizeMode:\"contain\",style:styles.tinyLogo,imageStyle:styles.image_imageStyle})),React.createElement(View,{style:styles.down},React.createElement(Text,{style:styles.someText},\"Donne un nom \\xE0 ta salle\")),React.createElement(View,null),React.createElement(CustomInput,{placeholder:\"Nom public de la salle\"})),React.createElement(View,{style:styles.mainButton},React.createElement(TextButton,{content:\"Cr\\xE9er la salle\",action:function _callee(){var response,responseCode;return _regeneratorRuntime.async(function _callee$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(setRoomToAp(user.id,textRoom,user.token));case 2:response=_context3.sent;if(!(response!=undefined&&response.idParty!=undefined)){_context3.next=12;break;}_context3.next=6;return _regeneratorRuntime.awrap(getCode(response.idParty,user.token));case 6:responseCode=_context3.sent;dispatch(setCurrentPartyId(response));dispatch(setCurrentPartyCode(responseCode));navigation.push(\"InitialMood\");_context3.next=13;break;case 12:console.log(\"Put pop up\");case 13:case\"end\":return _context3.stop();}}},null,null,null,Promise);}})));};var styles=StyleSheet.create({container:{flexDirection:\"column\",backgroundColor:'#120841',justifyContent:\"space-between\",flex:1},flexing:{flex:1},intitule:{marginTop:20},intitule2:{marginTop:10,marginBottom:60},tinyLogo:{width:120,height:120},head:{textAlignVertical:\"center\",textAlign:\"center\",fontSize:25,fontWeight:\"bold\",color:\"white\",fontFamily:\"Roboto_700Bold\"},head2:{color:\"white\",textAlignVertical:\"center\",textAlign:\"center\",fontSize:15,fontFamily:\"Roboto_300Light\"},imagerie:{flexDirection:\"row\",justifyContent:\"space-around\",marginBottom:60},down:{textAlignVertical:\"center\",textAlign:\"center\",marginBottom:20},mainButton:{marginBottom:40},someText:{padding:2,textAlignVertical:\"center\",textAlign:\"center\",justifyContent:\"center\",color:\"white\"},someInput:{justifyContent:\"flex-end\",height:40,alignContent:\"center\",padding:2}});export default CreateRoom;","map":{"version":3,"sources":["/home/jeanningros/lug/components/CreateRoom.js"],"names":["React","useState","useDispatch","useSelector","TextButton","CustomInput","setCurrentPartyCode","setCurrentPartyId","CreateRoom","navigation","textRoom","setTextRoom","user","state","dispatch","getCode","_party_id","_token","fetch","then","response","json","console","log","codeParty","code","catch","error","setRoomToAp","_creator_id","_name","idParty","party_id","styles","container","intitule","head","intitule2","head2","imagerie","require","tinyLogo","image_imageStyle","down","someText","mainButton","id","token","undefined","responseCode","push","StyleSheet","create","flexDirection","backgroundColor","justifyContent","flex","flexing","marginTop","marginBottom","width","height","textAlignVertical","textAlign","fontSize","fontWeight","color","fontFamily","padding","someInput","alignContent"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport {\n  Image,\n  StyleSheet,\n  Text,\n  View,\n  Button,\n  TouchableOpacity,\n  TextInput,\n} from \"react-native\";\nimport { useDispatch, useSelector } from 'react-redux';\n\n\n// import fontStyles from 'assets/fonts/Roboto-Light.ttf';\n\n\n\nimport TextButton from \"./common/TextButton.js\";\nimport CustomInput from \"./common/CustomInput.js\";\nimport { setCurrentPartyCode, setCurrentPartyId } from \"../redux/user.js\";\n\n// {\n  /* <IconButton action={function}/>\n        <Icon/>\n      </IconButton> */\n// }\n\n// {\n  /* TO DO: le texte du placeholder est généré automatiquement selon le nom spotify du créateur du salon.\nFaire comprendre visuellement que l'utilisateur peut simplement cliquer sur suivant sans avoir à rentrer du texte pour le nom de la salle\n  */\n// }\n\n\n\nconst CreateRoom = ({ navigation }) => {\n  const [textRoom, setTextRoom] = useState(\"\");\n  const user = useSelector((state) => state.user.user);\n  const dispatch = useDispatch();\n  \n  async function getCode (_party_id, _token) {\n    try {\n      let response = await fetch(`https://shangrila.pythonanywhere.com/code?token=${_token}&party_id=${_party_id}`)\n      .then((response) => response.json())\n      .then((json) => {\n      console.log (\"res test fun === \", json)\n  \n        return ({\n          codeParty: json.code,\n        })\n      })\n  .catch((error) => { console.error(error) });\n      console.log (\"res test fun === \", response)\n      return response;\n    } catch (error) {\n      console.error(error);\n    };\n  }\n\n  async function setRoomToAp (_creator_id, _name, _token) {\n    try {\n      let response = await fetch(`https://shangrila.pythonanywhere.com/createParty?token=${_token}&name=${_name}`)\n      .then((response) => response.json())\n      .then((json) => {\n        console.log(\"json ===== ===== \", json)\n        return ({\n          idParty: json.party_id, \n          \n        })\n      })\n     \n  .catch((error) => { console.error(error) });\n      console.log (\"res ======!!======\",response)\n      return response;\n    } catch (error) {\n      console.error(error);\n    };\n  \n}\n  return (\n    <View style={styles.container}>\n      <View>\n        <View style={styles.intitule}>\n          <Text style={styles.head}>Devenir leader</Text>\n        </View>\n        <View style={styles.intitule2}>  \n          <Text style={styles.head2}>Connecte ton compte</Text>\n        </View>\n        <View style={styles.imagerie}>\n          <Image\n            source={require(\"../assets/spotify.jpg\")}\n            resizeMode=\"contain\"\n            style={styles.tinyLogo}\n            imageStyle={styles.image_imageStyle}\n          />\n          <Image\n            source={require(\"../assets/deezer.jpg\")}\n            resizeMode=\"contain\"\n            style={styles.tinyLogo}\n            imageStyle={styles.image_imageStyle}\n          />\n        </View>\n        <View style={styles.down}>\n          <Text style={styles.someText}>Donne un nom à ta salle</Text>\n        </View>\n        <View>\n          {/* <TextInput\n            style={styles.someInput}\n            placeholder=\" Nom d'utilisateur \"\n            onChangeText={(textRoom) => setTextRoom(textRoom)}\n            defaultValue={textRoom}\n          /> */}\n        </View>\n        <CustomInput placeholder=\"Nom public de la salle\"/>\n      </View>\n      <View style={styles.mainButton}>\n        <TextButton\n          content=\"Créer la salle\" \n          action={async () => {\n\n            let response = await setRoomToAp(user.id, textRoom, user.token);\n\n            if (response != undefined && response.idParty != undefined) {\n              let responseCode = await getCode( response.idParty, user.token)\n              dispatch(setCurrentPartyId(response));\n              dispatch(setCurrentPartyCode(responseCode));\n\n              navigation.push(\"InitialMood\")\n            } else {\n              console.log(\"Put pop up\");\n            }\n          }}  \n        />\n\n\n      </View>\n    </View>\n  );\n};\n\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"column\",\n    backgroundColor: '#120841',\n    justifyContent: \"space-between\",\n    flex: 1,\n  },\n  flexing: {\n    flex: 1,\n  },\n  intitule: {\n    marginTop: 20,\n  },\n  intitule2: {\n    marginTop: 10,\n    marginBottom: 60,\n  },\n  tinyLogo: {\n    width: 120,\n    height: 120,\n  },\n  \n  head: {\n    textAlignVertical: \"center\",\n    textAlign: \"center\",\n    fontSize: 25,\n    fontWeight: \"bold\",\n    color: \"white\",\n    fontFamily: \"Roboto_700Bold\"\n  },\n  head2: {\n    color: \"white\",\n    textAlignVertical: \"center\",\n    textAlign: \"center\",\n    fontSize: 15,\n    fontFamily: \"Roboto_300Light\"    \n  },\n  imagerie: {\n    flexDirection: \"row\",\n    justifyContent:\"space-around\",\n    marginBottom: 60,\n  },\n  down: {\n    textAlignVertical: \"center\",\n    textAlign: \"center\",\n    marginBottom: 20,\n  },\n  mainButton: {\n    marginBottom: 40,\n  },\n  someText: {\n    padding: 2,\n    textAlignVertical: \"center\",\n    textAlign: \"center\",\n    justifyContent: \"center\",\n    color: \"white\",\n  },\n  someInput: {\n    justifyContent: \"flex-end\",\n    height: 40,\n    alignContent: \"center\",\n    padding: 2,\n  },\n\n});\n export default CreateRoom;"]},"metadata":{},"sourceType":"module"}